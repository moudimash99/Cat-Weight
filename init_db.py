import sqlite3
import os

# Create data directory if it doesn't exist
DATA_DIR = os.path.join(os.path.dirname(__file__), 'data')
os.makedirs(DATA_DIR, exist_ok=True)
DB_NAME = os.path.join(DATA_DIR, 'cat_data.db')

# --- Your Data ---
simba_data = [
    ("2025-10-25 12:00", 0.810), ("2025-10-30 12:00", 0.870), ("2025-11-02 12:00", 1.012), 
    ("2025-11-04 12:00", 1.080), ("2025-11-05 20:45", 1.072), ("2025-11-06 20:13", 1.136), 
    ("2025-11-07 12:00", 1.173), ("2025-11-08 23:50", 1.260), ("2025-11-10 12:00", 1.127), 
    ("2025-11-11 11:30", 1.193), ("2025-11-11 22:47", 1.255), ("2025-11-11 23:00", 1.225), 
    ("2025-11-12 18:36", 1.230), ("2025-11-13 08:00", 1.273), ("2025-11-15 21:00", 1.379), 
    ("2025-11-17 12:00", 1.415), ("2025-11-20 12:00", 1.545), ("2025-11-23 12:00", 1.605), 
    ("2025-11-25 12:00", 1.660), ("2025-11-26 08:00", 1.695), ("2025-11-27 12:00", 1.810), 
    ("2025-11-28 18:27", 1.810), ("2025-11-29 12:00", 1.850), ("2025-11-30 08:00", 1.815), 
    ("2025-11-30 23:00", 1.935), ("2025-12-01 23:00", 1.965), ("2025-12-02 23:00", 2.050), 
    ("2025-12-03 23:00", 2.080), ("2025-12-05 18:35", 2.050), ("2025-12-06 02:43", 2.045), 
    ("2025-12-06 23:00", 2.125), ("2025-12-07 08:00", 2.170), ("2025-12-08 20:26", 2.175), 
    ("2025-12-09 09:33", 2.220), ("2025-12-10 09:00", 2.250), ("2025-12-11 08:52", 2.315), 
    ("2025-12-12 09:00", 2.350), ("2025-12-13 09:00", 2.345), ("2025-12-14 09:00", 2.305), 
    ("2025-12-15 08:52", 2.395), ("2025-12-16 12:00", 2.445), ("2025-12-18 12:00", 2.570), 
    ("2025-12-20 12:00", 2.555), ("2025-12-21 12:00", 2.700), ("2025-12-22 12:00", 2.700), 
    ("2025-12-30 12:00", 2.920), ("2026-01-07 12:51", 3.255), ("2026-01-11 16:09", 3.290)
]

nala_data = [
    ("2025-10-25 12:00", 0.800), ("2025-10-30 12:00", 0.820), ("2025-11-02 12:00", 0.985), 
    ("2025-11-04 12:00", 1.043), ("2025-11-05 20:45", 1.043), ("2025-11-06 20:13", 1.093), 
    ("2025-11-07 12:00", 1.117), ("2025-11-08 23:50", 1.188), ("2025-11-10 12:00", 1.137), 
    ("2025-11-11 11:30", 1.183), ("2025-11-11 21:16", 1.175), ("2025-11-11 22:47", 1.230), 
    ("2025-11-11 23:00", 1.210), ("2025-11-12 18:36", 1.210), ("2025-11-13 08:00", 1.265), 
    ("2025-11-15 21:00", 1.368), ("2025-11-17 12:00", 1.350), ("2025-11-20 12:00", 1.515), 
    ("2025-11-23 12:00", 1.570), ("2025-11-25 12:00", 1.585), ("2025-11-26 08:00", 1.595), 
    ("2025-11-27 12:00", 1.715), ("2025-11-28 18:27", 1.705), ("2025-11-29 12:00", 1.755), 
    ("2025-11-30 08:00", 1.715), ("2025-11-30 23:00", 1.795), ("2025-12-01 23:00", 1.820), 
    ("2025-12-02 23:00", 1.850), ("2025-12-03 23:00", 1.935), ("2025-12-05 18:27", 1.840), 
    ("2025-12-06 02:43", 1.870), ("2025-12-06 23:00", 1.895), ("2025-12-07 08:00", 1.935), 
    ("2025-12-08 20:25", 1.965), ("2025-12-09 09:35", 2.005), ("2025-12-10 09:00", 2.050), 
    ("2025-12-11 08:48", 2.070), ("2025-12-12 09:00", 2.050), ("2025-12-13 09:00", 2.065), 
    ("2025-12-14 09:00", 2.070), ("2025-12-15 08:55", 2.115), ("2025-12-16 12:00", 2.145), 
    ("2025-12-18 12:00", 2.200), ("2025-12-20 12:00", 2.245), ("2025-12-21 12:00", 2.330), 
    ("2025-12-22 12:00", 2.330), ("2025-12-30 12:00", 2.550), ("2026-01-07 12:55", 2.690), 
    ("2026-01-11 16:12", 2.690)
]

def init_db():
    conn = sqlite3.connect(DB_NAME)
    c = conn.cursor()
    # Drop table if exists to start fresh (for dev purposes)
    c.execute("DROP TABLE IF EXISTS weights")
    # Create table
    c.execute('''CREATE TABLE weights 
                 (id INTEGER PRIMARY KEY, cat_name TEXT, date_str TEXT, weight REAL)''')
    
    # Insert Data
    for row in simba_data:
        c.execute("INSERT INTO weights (cat_name, date_str, weight) VALUES (?, ?, ?)", 
                  ("Simba", row[0], row[1]))
        
    for row in nala_data:
        c.execute("INSERT INTO weights (cat_name, date_str, weight) VALUES (?, ?, ?)", 
                  ("Nala", row[0], row[1]))

    conn.commit()
    conn.close()
    print("Database initialized with Simba and Nala's data!")

if __name__ == '__main__':
    init_db()